 World Streaming (Scene Stacking) System - Implementation Plan                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 Overview                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
 Implementar un sistema de carga dinámica de chunks de 256x256m usando Addressables con FishNet networking. Las Safe Zones son independientes de los chunks mediante triggers físicos en Layer 9.                                                                      
                                                                                                                                                                                                                                                                       
 Arquitectura clave:                                                                                                                                                                                                                                                   
 - Chunk Loading: Client-driven (9-slice grid basado en posición del jugador)                                                                                                                                                                                          
 - Safe Zone Detection: Server-driven (triggers físicos, SyncVar replicado)                                                                                                                                                                                            
 - Scene Migration: Server mueve NetworkObjects a escenas de chunks para FishNet Scene Conditions                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 File Structure                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 Assets/_Project/                                                                                                                                                                                                                                                      
 ├── 0_Core/                                                                                                                                                                                                                                                           
 │   ├── World/                                                                                                                                                                                                                                                        
 │   │   ├── ChunkCoordinate.cs                    (NEW)                                                                                                                                                                                                               
 │   │   └── WorldStreamingEvents.cs               (NEW)                                                                                                                                                                                                               
 │   └── Networking/                                                                                                                                                                                                                                                   
 │       └── ServerSceneHandler.cs                 (NEW)                                                                                                                                                                                                               
 │                                                                                                                                                                                                                                                                     
 ├── 1_Data/                                                                                                                                                                                                                                                           
 │   ├── ScriptableObjects/World/                                                                                                                                                                                                                                      
 │   │   ├── ChunkData.cs                          (NEW)                                                                                                                                                                                                               
 │   │   └── WorldDatabase.cs                      (NEW)                                                                                                                                                                                                               
 │   └── Resources/Databases/                                                                                                                                                                                                                                          
 │       └── WorldDatabase.asset                   (CREATE via menu)                                                                                                                                                                                                   
 │                                                                                                                                                                                                                                                                     
 ├── 2_Simulation/                                                                                                                                                                                                                                                     
 │   ├── World/                                                                                                                                                                                                                                                        
 │   │   ├── Tracking/                                                                                                                                                                                                                                                 
 │   │   │   └── PlayerChunkTracker.cs             (NEW)                                                                                                                                                                                                               
 │   │   ├── Loading/                                                                                                                                                                                                                                                  
 │   │   │   └── ChunkLoaderManager.cs             (NEW)                                                                                                                                                                                                               
 │   │   ├── Zones/                                                                                                                                                                                                                                                    
 │   │   │   ├── ZoneTrigger.cs                    (NEW)                                                                                                                                                                                                               
 │   │   │   └── PlayerState.cs                    (NEW)                                                                                                                                                                                                               
 │   │   └── Validation/                                                                                                                                                                                                                                               
 │   │       └── CombatValidator.cs                (NEW)                                                                                                                                                                                                               
 │   └── Entities/Player/                                                                                                                                                                                                                                              
 │       ├── PlayerStats.cs                        (MODIFY)                                                                                                                                                                                                            
 │       └── PlayerCombat.cs                       (MODIFY)                                                                                                                                                                                                            
 │                                                                                                                                                                                                                                                                     
 ├── 3_Presentation/                                                                                                                                                                                                                                                   
 │   └── UI/SafeZone/                                                                                                                                                                                                                                                  
 │       └── SafeZoneIndicatorUI.cs                (NEW - UI icon)                                                                                                                                                                                                     
 │                                                                                                                                                                                                                                                                     
 ├── 4_Bootstrap/                                                                                                                                                                                                                                                      
 │   └── Bootstrap/                                                                                                                                                                                                                                                    
 │       └── WorldStreamingBootstrap.cs            (NEW)                                                                                                                                                                                                               
 │                                                                                                                                                                                                                                                                     
 └── 5_Content/                                                                                                                                                                                                                                                        
     ├── Scenes/Chunks/                                                                                                                                                                                                                                                
     │   ├── Chunk_0_0.unity                       (CREATE manually)                                                                                                                                                                                                   
     │   ├── Chunk_0_1.unity                       (CREATE manually)                                                                                                                                                                                                   
     │   └── ...                                                                                                                                                                                                                                                       
     └── Prefabs/World/                                                                                                                                                                                                                                                
         └── SafeZoneTrigger.prefab                (CREATE)                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Implementation Steps                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 PHASE 1: Core Infrastructure (0_Core, 1_Data)                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 1.1 ChunkCoordinate.cs                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/0_Core/World/ChunkCoordinate.cs                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 namespace Genesis.Core {                                                                                                                                                                                                                                              
     [System.Serializable]                                                                                                                                                                                                                                             
     public struct ChunkCoordinate : IEquatable<ChunkCoordinate> {                                                                                                                                                                                                     
         public int X;                                                                                                                                                                                                                                                 
         public int Y;                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
         public const int CHUNK_SIZE = 256;                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
         public static ChunkCoordinate FromWorldPosition(Vector3 worldPos) {                                                                                                                                                                                           
             int x = Mathf.FloorToInt(worldPos.x / CHUNK_SIZE);                                                                                                                                                                                                        
             int z = Mathf.FloorToInt(worldPos.z / CHUNK_SIZE);                                                                                                                                                                                                        
             return new ChunkCoordinate(x, z);                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public Vector3 GetChunkCenterWorld() {                                                                                                                                                                                                                        
             float centerOffset = CHUNK_SIZE / 2f;                                                                                                                                                                                                                     
             return new Vector3(X * CHUNK_SIZE + centerOffset, 0, Y * CHUNK_SIZE + centerOffset);                                                                                                                                                                      
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public List<ChunkCoordinate> GetNeighbors() {                                                                                                                                                                                                                 
             // Returns 8 surrounding chunks for 9-slice grid                                                                                                                                                                                                          
             return new List<ChunkCoordinate> {                                                                                                                                                                                                                        
                 new ChunkCoordinate(X - 1, Y + 1), // NW                                                                                                                                                                                                              
                 new ChunkCoordinate(X, Y + 1),     // N                                                                                                                                                                                                               
                 new ChunkCoordinate(X + 1, Y + 1), // NE                                                                                                                                                                                                              
                 new ChunkCoordinate(X - 1, Y),     // W                                                                                                                                                                                                               
                 new ChunkCoordinate(X + 1, Y),     // E                                                                                                                                                                                                               
                 new ChunkCoordinate(X - 1, Y - 1), // SW                                                                                                                                                                                                              
                 new ChunkCoordinate(X, Y - 1),     // S                                                                                                                                                                                                               
                 new ChunkCoordinate(X + 1, Y - 1)  // SE                                                                                                                                                                                                              
             };                                                                                                                                                                                                                                                        
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         // IEquatable implementation, GetHashCode, ToString                                                                                                                                                                                                           
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 1.2 WorldStreamingEvents.cs                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/0_Core/World/WorldStreamingEvents.cs                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 namespace Genesis.Core {                                                                                                                                                                                                                                              
     public static class WorldStreamingEvents {                                                                                                                                                                                                                        
         public const string PLAYER_CHUNK_CHANGED = "OnPlayerChunkChanged";                                                                                                                                                                                            
         public const string CHUNK_LOAD_COMPLETED = "OnChunkLoadCompleted";                                                                                                                                                                                            
         public const string PLAYER_ZONE_CHANGED = "OnPlayerZoneChanged";                                                                                                                                                                                              
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 1.3 ChunkData.cs                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/1_Data/ScriptableObjects/World/ChunkData.cs                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 namespace Genesis.Data {                                                                                                                                                                                                                                              
     [CreateAssetMenu(fileName = "Chunk_X_Y", menuName = "Genesis/World/Chunk Data")]                                                                                                                                                                                  
     public class ChunkData : ScriptableObject {                                                                                                                                                                                                                       
         [Header("Identity")]                                                                                                                                                                                                                                          
         public Vector2Int Coordinate;                                                                                                                                                                                                                                 
         public string ChunkName;                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
         [Header("Scene Reference")]                                                                                                                                                                                                                                   
         [Tooltip("Addressables reference to the chunk scene")]                                                                                                                                                                                                        
         public AssetReference SceneAsset;                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         [Header("Spawn Points")]                                                                                                                                                                                                                                      
         [Tooltip("If IsStartingChunk=true, players can spawn at these positions")]                                                                                                                                                                                    
         public bool IsStartingChunk;                                                                                                                                                                                                                                  
         public Vector3[] SpawnPositions;                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
         [Header("Metadata")]                                                                                                                                                                                                                                          
         public string BiomeType; // Future: weather, ambience                                                                                                                                                                                                         
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Key Points:                                                                                                                                                                                                                                                           
 - NO incluye isSafeZone (zones son físicas, no metadata)                                                                                                                                                                                                              
 - Incluye SpawnPositions[] para cada chunk (según respuesta del usuario)                                                                                                                                                                                              
 - IsStartingChunk marca chunks válidos para spawn inicial                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 1.4 WorldDatabase.cs                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/1_Data/ScriptableObjects/World/WorldDatabase.cs                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 namespace Genesis.Data {                                                                                                                                                                                                                                              
     [CreateAssetMenu(fileName = "WorldDatabase", menuName = "Genesis/World/World Database")]                                                                                                                                                                          
     public class WorldDatabase : ScriptableObject {                                                                                                                                                                                                                   
         [SerializeField] private List<ChunkData> chunks = new List<ChunkData>();                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
         private Dictionary<Vector2Int, ChunkData> _lookup;                                                                                                                                                                                                            
         private static WorldDatabase _instance;                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                       
         public static WorldDatabase Instance {                                                                                                                                                                                                                        
             get {                                                                                                                                                                                                                                                     
                 if (_instance == null) {                                                                                                                                                                                                                              
                     _instance = Resources.Load<WorldDatabase>("Databases/WorldDatabase");                                                                                                                                                                             
                 }                                                                                                                                                                                                                                                     
                 return _instance;                                                                                                                                                                                                                                     
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public void Initialize() {                                                                                                                                                                                                                                    
             _lookup = new Dictionary<Vector2Int, ChunkData>();                                                                                                                                                                                                        
             foreach (var chunk in chunks) {                                                                                                                                                                                                                           
                 _lookup[chunk.Coordinate] = chunk;                                                                                                                                                                                                                    
             }                                                                                                                                                                                                                                                         
             Debug.Log($"[WorldDatabase] Initialized with {chunks.Count} chunks");                                                                                                                                                                                     
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public ChunkData GetChunk(Vector2Int coord) {                                                                                                                                                                                                                 
             _lookup.TryGetValue(coord, out ChunkData data);                                                                                                                                                                                                           
             return data;                                                                                                                                                                                                                                              
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public ChunkData GetRandomStartingChunk() {                                                                                                                                                                                                                   
             var startingChunks = chunks.Where(c => c.IsStartingChunk).ToList();                                                                                                                                                                                       
             if (startingChunks.Count == 0) {                                                                                                                                                                                                                          
                 Debug.LogError("[WorldDatabase] No starting chunks defined!");                                                                                                                                                                                        
                 return chunks.FirstOrDefault();                                                                                                                                                                                                                       
             }                                                                                                                                                                                                                                                         
             return startingChunks[Random.Range(0, startingChunks.Count)];                                                                                                                                                                                             
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 PHASE 2: Safe Zone System (2_Simulation/World/Zones)                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 2.1 PlayerState.cs                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/2_Simulation/World/Zones/PlayerState.cs                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 namespace Genesis.Simulation.World {                                                                                                                                                                                                                                  
     [RequireComponent(typeof(NetworkObject))]                                                                                                                                                                                                                         
     public class PlayerState : NetworkBehaviour {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
         private readonly SyncVar<bool> _isInSafeZone = new SyncVar<bool>(false);                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
         public bool IsInSafeZone => _isInSafeZone.Value;                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
         public override void OnStartNetwork() {                                                                                                                                                                                                                       
             base.OnStartNetwork();                                                                                                                                                                                                                                    
             _isInSafeZone.OnChange += OnSafeZoneChanged;                                                                                                                                                                                                              
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         [Server]                                                                                                                                                                                                                                                      
         public void SetSafeZone(bool inSafeZone) {                                                                                                                                                                                                                    
             if (_isInSafeZone.Value == inSafeZone) return;                                                                                                                                                                                                            
             _isInSafeZone.Value = inSafeZone;                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private void OnSafeZoneChanged(bool oldValue, bool newValue, bool asServer) {                                                                                                                                                                                 
             if (base.IsOwner) {                                                                                                                                                                                                                                       
                 EventBus.Trigger(WorldStreamingEvents.PLAYER_ZONE_CHANGED, newValue);                                                                                                                                                                                 
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 2.2 ZoneTrigger.cs                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/2_Simulation/World/Zones/ZoneTrigger.cs                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 namespace Genesis.Simulation.World {                                                                                                                                                                                                                                  
     [RequireComponent(typeof(BoxCollider))]                                                                                                                                                                                                                           
     public class ZoneTrigger : MonoBehaviour {                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
         [Header("Zone Config")]                                                                                                                                                                                                                                       
         [SerializeField] private ZoneType zoneType = ZoneType.SafeZone;                                                                                                                                                                                               
         [SerializeField] private string zoneName = "Safe Zone";                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                       
         void Awake() {                                                                                                                                                                                                                                                
             Collider col = GetComponent<Collider>();                                                                                                                                                                                                                  
             col.isTrigger = true;                                                                                                                                                                                                                                     
             gameObject.layer = LayerMask.NameToLayer("SafeZone"); // Layer 9                                                                                                                                                                                          
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void OnTriggerEnter(Collider other) {                                                                                                                                                                                                                         
             if (!FishNet.InstanceFinder.IsServer) return;                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
             NetworkObject netObj = other.GetComponent<NetworkObject>();                                                                                                                                                                                               
             if (netObj == null) return;                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
             PlayerState playerState = netObj.GetComponent<PlayerState>();                                                                                                                                                                                             
             if (playerState == null) return;                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
             if (zoneType == ZoneType.SafeZone) {                                                                                                                                                                                                                      
                 playerState.SetSafeZone(true);                                                                                                                                                                                                                        
                 Debug.Log($"[ZoneTrigger] Player {netObj.ObjectId} entered {zoneName}");                                                                                                                                                                              
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void OnTriggerExit(Collider other) {                                                                                                                                                                                                                          
             if (!FishNet.InstanceFinder.IsServer) return;                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
             NetworkObject netObj = other.GetComponent<NetworkObject>();                                                                                                                                                                                               
             if (netObj == null) return;                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
             PlayerState playerState = netObj.GetComponent<PlayerState>();                                                                                                                                                                                             
             if (playerState == null) return;                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
             if (zoneType == ZoneType.SafeZone) {                                                                                                                                                                                                                      
                 playerState.SetSafeZone(false);                                                                                                                                                                                                                       
                 Debug.Log($"[ZoneTrigger] Player {netObj.ObjectId} exited {zoneName}");                                                                                                                                                                               
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
     public enum ZoneType {                                                                                                                                                                                                                                            
         SafeZone,                                                                                                                                                                                                                                                     
         PvPZone,     // Future                                                                                                                                                                                                                                        
         ResourceZone // Future                                                                                                                                                                                                                                        
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 2.3 CombatValidator.cs                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/2_Simulation/World/Validation/CombatValidator.cs                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 namespace Genesis.Simulation.World {                                                                                                                                                                                                                                  
     public static class CombatValidator {                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         [Server]                                                                                                                                                                                                                                                      
         public static bool CanApplyDamage(NetworkObject victim, NetworkObject attacker, out string reason) {                                                                                                                                                          
             reason = null;                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
             if (victim == null) {                                                                                                                                                                                                                                     
                 reason = "Invalid victim";                                                                                                                                                                                                                            
                 return false;                                                                                                                                                                                                                                         
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             PlayerState victimState = victim.GetComponent<PlayerState>();                                                                                                                                                                                             
             if (victimState != null && victimState.IsInSafeZone) {                                                                                                                                                                                                    
                 reason = "Target is in a safe zone";                                                                                                                                                                                                                  
                 return false;                                                                                                                                                                                                                                         
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             if (attacker != null) {                                                                                                                                                                                                                                   
                 PlayerState attackerState = attacker.GetComponent<PlayerState>();                                                                                                                                                                                     
                 if (attackerState != null && attackerState.IsInSafeZone) {                                                                                                                                                                                            
                     reason = "Cannot attack from safe zone";                                                                                                                                                                                                          
                     return false;                                                                                                                                                                                                                                     
                 }                                                                                                                                                                                                                                                     
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             return true;                                                                                                                                                                                                                                              
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 PHASE 3: Chunk Loading System (2_Simulation/World)                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 3.1 PlayerChunkTracker.cs                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/2_Simulation/World/Tracking/PlayerChunkTracker.cs                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 namespace Genesis.Simulation.World {                                                                                                                                                                                                                                  
     [RequireComponent(typeof(NetworkObject))]                                                                                                                                                                                                                         
     public class PlayerChunkTracker : NetworkBehaviour {                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
         private ChunkCoordinate _currentChunk;                                                                                                                                                                                                                        
         private ChunkCoordinate _previousChunk;                                                                                                                                                                                                                       
         private float _checkInterval = 0.5f;                                                                                                                                                                                                                          
         private float _nextCheckTime;                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
         private ServerSceneHandler _sceneHandler;                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
         public override void OnStartClient() {                                                                                                                                                                                                                        
             base.OnStartClient();                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
             _currentChunk = ChunkCoordinate.FromWorldPosition(transform.position);                                                                                                                                                                                    
             _previousChunk = _currentChunk;                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                       
             if (base.IsOwner) {                                                                                                                                                                                                                                       
                 EventBus.Trigger(WorldStreamingEvents.PLAYER_CHUNK_CHANGED, _currentChunk);                                                                                                                                                                           
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public override void OnStartServer() {                                                                                                                                                                                                                        
             base.OnStartServer();                                                                                                                                                                                                                                     
             _sceneHandler = FindObjectOfType<ServerSceneHandler>();                                                                                                                                                                                                   
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void Update() {                                                                                                                                                                                                                                               
             if (!base.IsOwner) return;                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
             if (Time.time < _nextCheckTime) return;                                                                                                                                                                                                                   
             _nextCheckTime = Time.time + _checkInterval;                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
             ChunkCoordinate newChunk = ChunkCoordinate.FromWorldPosition(transform.position);                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             if (!newChunk.Equals(_currentChunk)) {                                                                                                                                                                                                                    
                 _previousChunk = _currentChunk;                                                                                                                                                                                                                       
                 _currentChunk = newChunk;                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
                 EventBus.Trigger(WorldStreamingEvents.PLAYER_CHUNK_CHANGED, _currentChunk);                                                                                                                                                                           
                 CmdNotifyChunkChange(newChunk);                                                                                                                                                                                                                       
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         [ServerRpc]                                                                                                                                                                                                                                                   
         private void CmdNotifyChunkChange(ChunkCoordinate newChunk) {                                                                                                                                                                                                 
             if (_sceneHandler != null) {                                                                                                                                                                                                                              
                 _sceneHandler.MovePlayerToChunkScene(base.NetworkObject, newChunk);                                                                                                                                                                                   
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         public ChunkCoordinate GetCurrentChunk() => _currentChunk;                                                                                                                                                                                                    
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 3.2 ChunkLoaderManager.cs                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/2_Simulation/World/Loading/ChunkLoaderManager.cs                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 namespace Genesis.Simulation.World {                                                                                                                                                                                                                                  
     public class ChunkLoaderManager : MonoBehaviour {                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
         private HashSet<ChunkCoordinate> _loadedChunks = new HashSet<ChunkCoordinate>();                                                                                                                                                                              
         private Dictionary<ChunkCoordinate, AsyncOperationHandle<SceneInstance>> _loadOperations = new Dictionary<ChunkCoordinate, AsyncOperationHandle<SceneInstance>>();                                                                                            
                                                                                                                                                                                                                                                                       
         private WorldDatabase _worldDB;                                                                                                                                                                                                                               
         private bool _isServer;                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                       
         void Start() {                                                                                                                                                                                                                                                
             _worldDB = ServiceLocator.Instance.Get<WorldDatabase>();                                                                                                                                                                                                  
             _isServer = FishNet.InstanceFinder.IsServer;                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
             EventBus.Subscribe<ChunkCoordinate>(WorldStreamingEvents.PLAYER_CHUNK_CHANGED, OnPlayerChunkChanged);                                                                                                                                                     
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private void OnPlayerChunkChanged(ChunkCoordinate newChunk) {                                                                                                                                                                                                 
             HashSet<ChunkCoordinate> requiredChunks = new HashSet<ChunkCoordinate>();                                                                                                                                                                                 
             requiredChunks.Add(newChunk);                                                                                                                                                                                                                             
             requiredChunks.UnionWith(newChunk.GetNeighbors());                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
             var chunksToUnload = _loadedChunks.Except(requiredChunks);                                                                                                                                                                                                
             foreach (var chunk in chunksToUnload) {                                                                                                                                                                                                                   
                 UnloadChunk(chunk);                                                                                                                                                                                                                                   
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             var chunksToLoad = requiredChunks.Except(_loadedChunks);                                                                                                                                                                                                  
             foreach (var chunk in chunksToLoad) {                                                                                                                                                                                                                     
                 LoadChunk(chunk);                                                                                                                                                                                                                                     
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private async void LoadChunk(ChunkCoordinate coord) {                                                                                                                                                                                                         
             ChunkData data = _worldDB.GetChunk(new Vector2Int(coord.X, coord.Y));                                                                                                                                                                                     
             if (data == null) {                                                                                                                                                                                                                                       
                 Debug.LogWarning($"[ChunkLoader] No data for chunk {coord}");                                                                                                                                                                                         
                 return;                                                                                                                                                                                                                                               
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             var handle = Addressables.LoadSceneAsync(data.SceneAsset, LoadSceneMode.Additive);                                                                                                                                                                        
             _loadOperations[coord] = handle;                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
             await handle.Task;                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
             if (handle.Status == AsyncOperationStatus.Succeeded) {                                                                                                                                                                                                    
                 _loadedChunks.Add(coord);                                                                                                                                                                                                                             
                 EventBus.Trigger(WorldStreamingEvents.CHUNK_LOAD_COMPLETED, coord);                                                                                                                                                                                   
                 Debug.Log($"[ChunkLoader] Loaded chunk {coord} ({(_isServer ? "Server" : "Client")})");                                                                                                                                                               
             } else {                                                                                                                                                                                                                                                  
                 Debug.LogError($"[ChunkLoader] Failed to load chunk {coord}");                                                                                                                                                                                        
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private void UnloadChunk(ChunkCoordinate coord) {                                                                                                                                                                                                             
             if (!_loadOperations.TryGetValue(coord, out var handle)) return;                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
             Addressables.UnloadSceneAsync(handle);                                                                                                                                                                                                                    
             _loadOperations.Remove(coord);                                                                                                                                                                                                                            
             _loadedChunks.Remove(coord);                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
             Debug.Log($"[ChunkLoader] Unloaded chunk {coord}");                                                                                                                                                                                                       
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void OnDestroy() {                                                                                                                                                                                                                                            
             EventBus.Unsubscribe<ChunkCoordinate>(WorldStreamingEvents.PLAYER_CHUNK_CHANGED, OnPlayerChunkChanged);                                                                                                                                                   
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 3.3 ServerSceneHandler.cs                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/0_Core/Networking/ServerSceneHandler.cs                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 namespace Genesis.Core.Networking {                                                                                                                                                                                                                                   
     public class ServerSceneHandler : NetworkBehaviour {                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
         [Server]                                                                                                                                                                                                                                                      
         public void MovePlayerToChunkScene(NetworkObject player, ChunkCoordinate chunk) {                                                                                                                                                                             
             string sceneName = $"Chunk_{chunk.X}_{chunk.Y}";                                                                                                                                                                                                          
             Scene targetScene = SceneManager.GetSceneByName(sceneName);                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
             if (!targetScene.IsValid() || !targetScene.isLoaded) {                                                                                                                                                                                                    
                 Debug.LogError($"[ServerSceneHandler] Cannot move player to {sceneName} - scene not loaded!");                                                                                                                                                        
                 return;                                                                                                                                                                                                                                               
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             SceneManager.MoveGameObjectToScene(player.gameObject, targetScene);                                                                                                                                                                                       
             Debug.Log($"[ServerSceneHandler] Moved {player.name} to scene {sceneName}");                                                                                                                                                                              
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 PHASE 4: Integration with Existing Systems                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 4.1 Modify PlayerStats.cs                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 File: Assets/_Project/2_Simulation/Entities/Player/PlayerStats.cs                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Location: Line 104, inside TakeDamage method                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
 Add BEFORE existing status effects check:                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 [Server]                                                                                                                                                                                                                                                              
 public void TakeDamage(float damage, NetworkObject attacker) {                                                                                                                                                                                                        
     if (_isDead) return;                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
     // NEW: Safe Zone Validation                                                                                                                                                                                                                                      
     if (!CombatValidator.CanApplyDamage(base.NetworkObject, attacker, out string reason)) {                                                                                                                                                                           
         Debug.Log($"[PlayerStats] Damage blocked: {reason}");                                                                                                                                                                                                         
         return;                                                                                                                                                                                                                                                       
     }                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
     // Existing status effects check (Invulnerable, Reflect)...                                                                                                                                                                                                       
     // Rest of existing code...                                                                                                                                                                                                                                       
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 4.2 Modify ProjectileController.cs                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 File: Assets/_Project/2_Simulation/Combat/Projectiles/ProjectileController.cs                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 Location: Line 111, in HandleImpact method, BEFORE damage application                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 Add BEFORE the if (targetNetObj.TryGetComponent(out IDamageable damageable)) block:                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 // After CASO 3 (Reflect check), before CASO 4 (Damage Normal)                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 // NEW: Safe Zone Validation (before damage)                                                                                                                                                                                                                          
 if (!CombatValidator.CanApplyDamage(targetNetObj, _owner, out string reason)) {                                                                                                                                                                                       
     Debug.Log($"[ProjectileController] Projectile hit blocked: {reason}");                                                                                                                                                                                            
     SpawnImpactVFX(hit.point, hit.normal); // Still show impact                                                                                                                                                                                                       
     Despawn();                                                                                                                                                                                                                                                        
     return;                                                                                                                                                                                                                                                           
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 // CASO 4: Daño Normal (existing code)...                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 4.3 Modify PlayerSpawnManager.cs                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
 File: Assets/_Project/0_Core/Networking/PlayerSpawnManager.cs                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 Location: Line 76, inside TrySpawnPlayer method                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                       
 Replace lines 87-94 with:                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 // Get random starting chunk from WorldDatabase                                                                                                                                                                                                                       
 WorldDatabase worldDB = ServiceLocator.Instance.Get<WorldDatabase>();                                                                                                                                                                                                 
 ChunkData startingChunk = worldDB.GetRandomStartingChunk();                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                       
 if (startingChunk == null || startingChunk.SpawnPositions.Length == 0) {                                                                                                                                                                                              
     Debug.LogError("[SpawnManager] No valid starting chunk with spawn positions!");                                                                                                                                                                                   
     return;                                                                                                                                                                                                                                                           
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 // Pick random spawn position from chunk                                                                                                                                                                                                                              
 Vector3 pos = startingChunk.SpawnPositions[Random.Range(0, startingChunk.SpawnPositions.Length)];                                                                                                                                                                     
 GameObject player = Instantiate(playerPrefab, pos, Quaternion.identity);                                                                                                                                                                                              
                                                                                                                                                                                                                                                                       
 // Add required components for world streaming                                                                                                                                                                                                                        
 if (!player.TryGetComponent<PlayerChunkTracker>(out _)) {                                                                                                                                                                                                             
     player.AddComponent<PlayerChunkTracker>();                                                                                                                                                                                                                        
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 if (!player.TryGetComponent<PlayerState>(out _)) {                                                                                                                                                                                                                    
     player.AddComponent<PlayerState>();                                                                                                                                                                                                                               
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 // Spawn networked object                                                                                                                                                                                                                                             
 _networkManager.ServerManager.Spawn(player, conn);                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 // Move to chunk scene (FishNet Scene Conditions)                                                                                                                                                                                                                     
 ChunkCoordinate spawnChunk = ChunkCoordinate.FromWorldPosition(pos);                                                                                                                                                                                                  
 ServerSceneHandler sceneHandler = FindObjectOfType<ServerSceneHandler>();                                                                                                                                                                                             
 if (sceneHandler != null) {                                                                                                                                                                                                                                           
     sceneHandler.MovePlayerToChunkScene(player.GetComponent<NetworkObject>(), spawnChunk);                                                                                                                                                                            
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Debug.Log($"[SpawnManager] Spawned player in chunk {spawnChunk} at {pos}");                                                                                                                                                                                           
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 PHASE 5: Bootstrap Integration                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 5.1 WorldStreamingBootstrap.cs                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/4_Bootstrap/Bootstrap/WorldStreamingBootstrap.cs                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 namespace Genesis.Bootstrap {                                                                                                                                                                                                                                         
     public class WorldStreamingBootstrap : MonoBehaviour {                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
         [SerializeField] private WorldDatabase worldDatabase;                                                                                                                                                                                                         
         [SerializeField] private GameObject chunkLoaderPrefab;                                                                                                                                                                                                        
         [SerializeField] private GameObject serverSceneHandlerPrefab;                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
         void Awake() {                                                                                                                                                                                                                                                
             if (worldDatabase == null) {                                                                                                                                                                                                                              
                 worldDatabase = Resources.Load<WorldDatabase>("Databases/WorldDatabase");                                                                                                                                                                             
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             if (worldDatabase != null) {                                                                                                                                                                                                                              
                 worldDatabase.Initialize();                                                                                                                                                                                                                           
                 ServiceLocator.Instance.Register(worldDatabase);                                                                                                                                                                                                      
                 Debug.Log("[WorldStreamingBootstrap] WorldDatabase initialized");                                                                                                                                                                                     
             } else {                                                                                                                                                                                                                                                  
                 Debug.LogError("[WorldStreamingBootstrap] WorldDatabase not found!");                                                                                                                                                                                 
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void Start() {                                                                                                                                                                                                                                                
             // Wait for NetworkManager                                                                                                                                                                                                                                
             StartCoroutine(InitNetworkedComponents());                                                                                                                                                                                                                
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private IEnumerator InitNetworkedComponents() {                                                                                                                                                                                                               
             while (FishNet.InstanceFinder.NetworkManager == null) {                                                                                                                                                                                                   
                 yield return null;                                                                                                                                                                                                                                    
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             // Spawn ServerSceneHandler (server-only)                                                                                                                                                                                                                 
             if (FishNet.InstanceFinder.IsServer && serverSceneHandlerPrefab != null) {                                                                                                                                                                                
                 GameObject handler = Instantiate(serverSceneHandlerPrefab);                                                                                                                                                                                           
                 DontDestroyOnLoad(handler); // Exception: This handler needs persistence                                                                                                                                                                              
                 Debug.Log("[WorldStreamingBootstrap] ServerSceneHandler spawned");                                                                                                                                                                                    
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             // Spawn ChunkLoaderManager (client and server)                                                                                                                                                                                                           
             if (chunkLoaderPrefab != null) {                                                                                                                                                                                                                          
                 GameObject loader = Instantiate(chunkLoaderPrefab);                                                                                                                                                                                                   
                 DontDestroyOnLoad(loader); // Exception: This manager needs persistence                                                                                                                                                                               
                 Debug.Log("[WorldStreamingBootstrap] ChunkLoaderManager spawned");                                                                                                                                                                                    
             }                                                                                                                                                                                                                                                         
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Add to Bootstrap.unity scene:                                                                                                                                                                                                                                         
 - Create empty GameObject "WorldStreamingBootstrap"                                                                                                                                                                                                                   
 - Attach WorldStreamingBootstrap.cs                                                                                                                                                                                                                                   
 - Assign WorldDatabase reference                                                                                                                                                                                                                                      
 - Create prefabs for ChunkLoaderManager and ServerSceneHandler, assign references                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 PHASE 6: UI Feedback (Client-Side)                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 6.1 SafeZoneIndicatorUI.cs                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 Path: Assets/_Project/3_Presentation/UI/SafeZone/SafeZoneIndicatorUI.cs                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 namespace Genesis.Presentation.UI {                                                                                                                                                                                                                                   
     public class SafeZoneIndicatorUI : MonoBehaviour {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
         [SerializeField] private GameObject safeZoneIcon; // UI icon (shield icon)                                                                                                                                                                                    
         [SerializeField] private TMPro.TextMeshProUGUI safeZoneText;                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
         void Start() {                                                                                                                                                                                                                                                
             EventBus.Subscribe<bool>(WorldStreamingEvents.PLAYER_ZONE_CHANGED, OnZoneChanged);                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
             if (safeZoneIcon != null) safeZoneIcon.SetActive(false);                                                                                                                                                                                                  
             if (safeZoneText != null) safeZoneText.gameObject.SetActive(false);                                                                                                                                                                                       
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         private void OnZoneChanged(bool isInSafeZone) {                                                                                                                                                                                                               
             if (safeZoneIcon != null) {                                                                                                                                                                                                                               
                 safeZoneIcon.SetActive(isInSafeZone);                                                                                                                                                                                                                 
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             if (safeZoneText != null) {                                                                                                                                                                                                                               
                 safeZoneText.gameObject.SetActive(isInSafeZone);                                                                                                                                                                                                      
                 safeZoneText.text = "SAFE ZONE";                                                                                                                                                                                                                      
                 safeZoneText.color = Color.green;                                                                                                                                                                                                                     
             }                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
             Debug.Log($"[SafeZoneUI] Zone changed: {isInSafeZone}");                                                                                                                                                                                                  
         }                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
         void OnDestroy() {                                                                                                                                                                                                                                            
             EventBus.Unsubscribe<bool>(WorldStreamingEvents.PLAYER_ZONE_CHANGED, OnZoneChanged);                                                                                                                                                                      
         }                                                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                 
 }                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Add to HUD Canvas:                                                                                                                                                                                                                                                    
 - Create UI Image for shield icon (top-right corner)                                                                                                                                                                                                                  
 - Create TextMeshProUGUI for "SAFE ZONE" text                                                                                                                                                                                                                         
 - Attach SafeZoneIndicatorUI.cs to HUD root                                                                                                                                                                                                                           
 - Assign references                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Configuration Steps                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 1. Enable Addressables                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 1. Window > Asset Management > Addressables > Groups                                                                                                                                                                                                                  
 2. Create default Addressables settings (if not exists)                                                                                                                                                                                                               
 3. Create new group: "ChunkScenes"                                                                                                                                                                                                                                    
   - Build Path: LocalBuildPath                                                                                                                                                                                                                                        
   - Load Path: LocalLoadPath                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
 2. Configure Layers                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 Edit > Project Settings > Physics > Layer Collision Matrix                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 Ensure Layer 9 (SafeZone) is unchecked for ALL layers:                                                                                                                                                                                                                
 - Player: ✗                                                                                                                                                                                                                                                           
 - Enemy: ✗                                                                                                                                                                                                                                                            
 - Environment: ✗                                                                                                                                                                                                                                                      
 - SafeZone: ✗                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 This ensures triggers don't block movement but still fire OnTriggerEnter/Exit.                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 3. Create Chunk Scenes                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 Manual Creation Workflow:                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 1. Create new scene: Assets/_Project/5_Content/Scenes/Chunks/Chunk_0_0.unity                                                                                                                                                                                          
 2. Add terrain/geometry (256x256m bounds)                                                                                                                                                                                                                             
 3. Add ZoneTriggers where needed:                                                                                                                                                                                                                                     
   - GameObject > Create Empty > "SafeZone_Town"                                                                                                                                                                                                                       
   - Add Component > Box Collider (Is Trigger = true)                                                                                                                                                                                                                  
   - Set Layer to "SafeZone" (9)                                                                                                                                                                                                                                       
   - Add Component > ZoneTrigger.cs                                                                                                                                                                                                                                    
   - Configure size/position                                                                                                                                                                                                                                           
 4. Save scene                                                                                                                                                                                                                                                         
 5. Mark as Addressable:                                                                                                                                                                                                                                               
   - Select scene in Project                                                                                                                                                                                                                                           
   - Check "Addressable" in Inspector                                                                                                                                                                                                                                  
   - Set Address: "Chunks/Chunk_0_0"                                                                                                                                                                                                                                   
   - Set Group: "ChunkScenes"                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
 Repeat for each chunk (Chunk_0_1, Chunk_1_0, etc.)                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 4. Create ChunkData Assets                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 1. Right-click in Project > Create > Genesis > World > Chunk Data                                                                                                                                                                                                     
 2. Name: "Chunk_0_0_Data"                                                                                                                                                                                                                                             
 3. Configure:                                                                                                                                                                                                                                                         
   - Coordinate: (0, 0)                                                                                                                                                                                                                                                
   - ChunkName: "Plains Center"                                                                                                                                                                                                                                        
   - SceneAsset: Drag "Chunk_0_0" scene reference                                                                                                                                                                                                                      
   - IsStartingChunk: true (for starting areas)                                                                                                                                                                                                                        
   - SpawnPositions: Add Vector3[] positions (e.g., (128, 0, 128) for center)                                                                                                                                                                                          
 4. Save                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 Repeat for each chunk                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 5. Create WorldDatabase                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 1. Right-click in Assets/_Project/1_Data/Resources/Databases/ > Create > Genesis > World > World Database                                                                                                                                                             
 2. Name: "WorldDatabase"                                                                                                                                                                                                                                              
 3. Add all ChunkData assets to "Chunks" list                                                                                                                                                                                                                          
 4. Save                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 6. Configure Bootstrap Scene                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                       
 1. Open Assets/_Project/4_Bootstrap/Bootstrap.unity                                                                                                                                                                                                                   
 2. Create empty GameObject "WorldStreamingBootstrap"                                                                                                                                                                                                                  
 3. Add WorldStreamingBootstrap.cs component                                                                                                                                                                                                                           
 4. Assign WorldDatabase reference (drag from Resources/Databases/)                                                                                                                                                                                                    
 5. Create prefabs:                                                                                                                                                                                                                                                    
   - ChunkLoaderManager.prefab (empty GameObject + ChunkLoaderManager.cs)                                                                                                                                                                                              
   - ServerSceneHandler.prefab (empty GameObject + ServerSceneHandler.cs + NetworkObject)                                                                                                                                                                              
 6. Assign prefab references to WorldStreamingBootstrap                                                                                                                                                                                                                
 7. Save scene                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 7. Build Addressables                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 1. Window > Asset Management > Addressables > Groups                                                                                                                                                                                                                  
 2. Build > New Build > Default Build Script                                                                                                                                                                                                                           
 3. Wait for build to complete                                                                                                                                                                                                                                         
 4. Test in Play Mode (Fast Mode for iteration)                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Verification Plan                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Test 1: Chunk Loading Flow                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                       
 Setup:                                                                                                                                                                                                                                                                
 1. Create Chunk_0_0 and Chunk_0_1 (adjacent chunks)                                                                                                                                                                                                                   
 2. Set spawn position at x=255, z=128 (near boundary)                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 Steps:                                                                                                                                                                                                                                                                
 1. Start server + client                                                                                                                                                                                                                                              
 2. Player spawns in Chunk_0_0                                                                                                                                                                                                                                         
 3. Verify ChunkLoaderManager loads 9-slice grid (Console logs)                                                                                                                                                                                                        
 4. Walk forward 2 meters (cross to Chunk_0_1)                                                                                                                                                                                                                         
 5. Verify:                                                                                                                                                                                                                                                            
   - PlayerChunkTracker fires PLAYER_CHUNK_CHANGED event                                                                                                                                                                                                               
   - ChunkLoaderManager loads Chunk_0_1 + neighbors                                                                                                                                                                                                                    
   - Old chunks unload (check SceneManager.sceneCount)                                                                                                                                                                                                                 
   - Server logs "Moved player to scene Chunk_0_1"                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Expected: No errors, smooth transition, scenes load/unload correctly                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 Test 2: Safe Zone Trigger Detection                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 Setup:                                                                                                                                                                                                                                                                
 1. Add ZoneTrigger to Chunk_0_0 scene (BoxCollider, Layer 9, isTrigger=true)                                                                                                                                                                                          
 2. Size: 20x20m at position (128, 0, 128)                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                       
 Steps:                                                                                                                                                                                                                                                                
 1. Spawn player outside zone (150, 0, 150)                                                                                                                                                                                                                            
 2. Verify UI icon is hidden                                                                                                                                                                                                                                           
 3. Walk into zone (125, 0, 125)                                                                                                                                                                                                                                       
 4. Verify:                                                                                                                                                                                                                                                            
   - Server: OnTriggerEnter fires (console log)                                                                                                                                                                                                                        
   - PlayerState.IsInSafeZone becomes true                                                                                                                                                                                                                             
   - Client: UI icon appears (green shield + "SAFE ZONE" text)                                                                                                                                                                                                         
   - EventBus PLAYER_ZONE_CHANGED fires                                                                                                                                                                                                                                
 5. Walk out of zone (160, 0, 160)                                                                                                                                                                                                                                     
 6. Verify:                                                                                                                                                                                                                                                            
   - Server: OnTriggerExit fires                                                                                                                                                                                                                                       
   - PlayerState.IsInSafeZone becomes false                                                                                                                                                                                                                            
   - Client: UI icon disappears                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                       
 Expected: Instant UI feedback, no lag, server authority maintained                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Test 3: Combat Blocking in Safe Zone                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 Setup:                                                                                                                                                                                                                                                                
 1. Player A inside safe zone                                                                                                                                                                                                                                          
 2. Player B outside safe zone                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 Steps:                                                                                                                                                                                                                                                                
 1. Player B casts projectile at Player A                                                                                                                                                                                                                              
 2. Verify:                                                                                                                                                                                                                                                            
   - ProjectileController calls CombatValidator                                                                                                                                                                                                                        
   - CanApplyDamage returns false (reason: "Target is in a safe zone")                                                                                                                                                                                                 
   - Impact VFX spawns (visual feedback)                                                                                                                                                                                                                               
   - Player A health unchanged (no damage)                                                                                                                                                                                                                             
 3. Player A casts projectile at Player B (from inside safe zone)                                                                                                                                                                                                      
 4. Verify:                                                                                                                                                                                                                                                            
   - CombatValidator blocks (reason: "Cannot attack from safe zone")                                                                                                                                                                                                   
   - Player B health unchanged                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                       
 Expected: Damage blocked, console logs show reasons, no exploits                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                       
 Test 4: Multi-Player Chunk Loading                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Setup:                                                                                                                                                                                                                                                                
 1. 3 players in different chunks (Chunk_0_0, Chunk_1_0, Chunk_0_1)                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Steps:                                                                                                                                                                                                                                                                
 1. Verify each client only loads their 9-slice grid (9 scenes max per client)                                                                                                                                                                                         
 2. Server loads all active chunks (27 scenes if far apart)                                                                                                                                                                                                            
 3. Check memory usage (Unity Profiler > Memory)                                                                                                                                                                                                                       
 4. Verify no duplicate scene loads (SceneManager debug)                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                       
 Expected: Client memory < 500MB, Server memory stable, no duplicates                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 Test 5: Spawn System with ChunkData                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 Setup:                                                                                                                                                                                                                                                                
 1. ChunkData with IsStartingChunk=true, SpawnPositions = [(100,0,100), (150,0,150)]                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 Steps:                                                                                                                                                                                                                                                                
 1. Connect client                                                                                                                                                                                                                                                     
 2. Verify:                                                                                                                                                                                                                                                            
   - PlayerSpawnManager calls WorldDatabase.GetRandomStartingChunk()                                                                                                                                                                                                   
   - Player spawns at one of the defined positions                                                                                                                                                                                                                     
   - PlayerChunkTracker calculates correct chunk                                                                                                                                                                                                                       
   - ServerSceneHandler moves NetworkObject to chunk scene                                                                                                                                                                                                             
   - ChunkLoaderManager loads initial 9-slice grid                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 Expected: Player spawns at valid position, chunks load, no errors                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Critical Files Summary                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 New Files (13 total):                                                                                                                                                                                                                                                 
 - 0_Core/World/ChunkCoordinate.cs                                                                                                                                                                                                                                     
 - 0_Core/World/WorldStreamingEvents.cs                                                                                                                                                                                                                                
 - 0_Core/Networking/ServerSceneHandler.cs                                                                                                                                                                                                                             
 - 1_Data/ScriptableObjects/World/ChunkData.cs                                                                                                                                                                                                                         
 - 1_Data/ScriptableObjects/World/WorldDatabase.cs                                                                                                                                                                                                                     
 - 2_Simulation/World/Tracking/PlayerChunkTracker.cs                                                                                                                                                                                                                   
 - 2_Simulation/World/Loading/ChunkLoaderManager.cs                                                                                                                                                                                                                    
 - 2_Simulation/World/Zones/ZoneTrigger.cs                                                                                                                                                                                                                             
 - 2_Simulation/World/Zones/PlayerState.cs                                                                                                                                                                                                                             
 - 2_Simulation/World/Validation/CombatValidator.cs                                                                                                                                                                                                                    
 - 3_Presentation/UI/SafeZone/SafeZoneIndicatorUI.cs                                                                                                                                                                                                                   
 - 4_Bootstrap/Bootstrap/WorldStreamingBootstrap.cs                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                       
 Modified Files (3 total):                                                                                                                                                                                                                                             
 - 2_Simulation/Entities/Player/PlayerStats.cs (line 104)                                                                                                                                                                                                              
 - 2_Simulation/Combat/Projectiles/ProjectileController.cs (line 111)                                                                                                                                                                                                  
 - 0_Core/Networking/PlayerSpawnManager.cs (line 76-94)                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                       
 Assets to Create:                                                                                                                                                                                                                                                     
 - ChunkData assets (1 per chunk)                                                                                                                                                                                                                                      
 - WorldDatabase asset (1 total, in Resources/Databases/)                                                                                                                                                                                                              
 - Chunk scenes (manual creation, 256x256m each)                                                                                                                                                                                                                       
 - SafeZoneTrigger prefab (template)                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Notes                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
 - NO persistence: Sistema en memoria, chunks se cargan/descargan dinámicamente                                                                                                                                                                                        
 - Layer 9 SafeZone: Configurar collision matrix para no interferir con movimiento                                                                                                                                                                                     
 - Addressables Fast Mode: Usar durante desarrollo para iteración rápida                                                                                                                                                                                               
 - Server Headless: Server carga chunks sin rendering (solo física/triggers)                                                                                                                                                                                           
 - Scene Naming Convention: Chunk_X_Y (ej: Chunk_0_0, Chunk_-1_2)                                                                                                                                                                                                      
 - 9-Slice Grid: Current chunk + 8 neighbors = 9 scenes cargadas simultáneamente                                                                                                                                                                                       
 - Spawn Points: Definidos en ChunkData, no más Transform[] global                                                                                                                                                                                                     
 - UI Feedback: Ícono de safe zone en HUD (verde, aparece/desaparece)                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 ---                                                                                                                                                                                                                                                                   
 Implementation Order                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                       
 1. Create ChunkCoordinate, WorldStreamingEvents                                                                                                                                                                                                                       
 2. Create ChunkData, WorldDatabase ScriptableObjects                                                                                                                                                                                                                  
 3. Create PlayerState, ZoneTrigger, CombatValidator                                                                                                                                                                                                                   
 4. Modify PlayerStats and ProjectileController                                                                                                                                                                                                                        
 5. Create PlayerChunkTracker, ChunkLoaderManager, ServerSceneHandler                                                                                                                                                                                                  
 6. Modify PlayerSpawnManager                                                                                                                                                                                                                                          
 7. Create WorldStreamingBootstrap                                                                                                                                                                                                                                     
 8. Create SafeZoneIndicatorUI                                                                                                                                                                                                                                         
 9. Create test chunk scenes (Chunk_0_0, Chunk_0_1)                                                                                                                                                                                                                    
 10. Configure Addressables and layers                                                                                                                                                                                                                                 
 11. Test each phase incrementally   